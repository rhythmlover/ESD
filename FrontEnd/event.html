<!DOCTYPE HTML>
<!--
	Dopetrope by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>Event</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />

	<!-- Axios -->
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

	<script>
        function fetchEvents(event_id) {
            axios.get(`http://localhost:5003/events`)
                .then(response => {
                    console.log('Response:', response.data.data);
                    const events = response.data.data;
                    if (events.length === 0) {
                        document.getElementById('eventsContainer').innerHTML = "<p>No events available.</p>";
                        return;
                    }
                    let eventsHtml = '';
                    for (let i = 0; i < events.length; i++) {
                        const event = events[i];
                        
                        eventsHtml += `
                        	<div class="col-4 col-6-medium col-12-small">
                                <section class="box">
                                    <a href="${event.event_image}" class="image featured"><img src="${event.event_image}" width="200" height="200"></a>
                                    <header>
                                        <h3>${event.event_name}</h3>
                                        <h5 class="card-title">Event ID: ${event.event_id}</h5>
                                    </header>
                                    <footer>
                                        <p class="card-text">Event Date & Time: ${event.event_datetime}</p>
                                        <p class="card-text">Event Price: ${event.event_price}</p>
                                        <p class="card-text">Event Description: ${event.event_description}</p>
                                        <ul class="actions">
                                            <li><a href="localhost:5200/purchase_ticket/${event.event_id}" class="button alt">Purchase Ticket</a></li>
											<li<a href="#" class="button alt" onclick="viewReviews('${event.event_id}')">View Reviews</a></li>	
                                        </ul>
                                    </footer>
                                </section>
                            </div>
                        `;
                        
                    }
                    document.getElementById('eventsContainer').innerHTML = eventsHtml;
                })
                .catch(error => {
                    console.error('Error fetching events:', error);
                    document.getElementById('eventsContainer').innerHTML = "<p>Error fetching events.</p>";
                });
        }

        function viewReviews(event_id) {
            axios.get(`http://localhost:5001/users/101`)
                .then(response => {
                    const account_type = response.data.data.account_type;
                    let reviewPage;
                    if (account_type === 'admin') {
                        reviewPage = `admin_event_id_${event_id}_review.html`;
                    } else if (account_type === 'user') {
						// console.log(account_type)
                        reviewPage = `user_event_id_${event_id}_review.html`;
                    }
                    window.location.href = reviewPage;
                })
                .catch(error => {
                    console.error('Error fetching user details:', error);
                    alert("Failed to fetch user details. Please try again later.");
                });
        }
        // Fetch events when the page loads
        fetchEvents();
    </script>
</head>

<body class="homepage is-preload">
	<div id="page-wrapper">

		<!-- Header -->
		<section id="header">

			<!-- Logo -->
			<h1><a href="event.html">TicketMaster</a></h1>

			<!-- Nav -->
			<nav id="nav">
				<ul>
					<li class="current"><a href="event.html">Home</a></li>
					<li>
						<a href="#">View More</a>
						<ul>
							<li><a href="#">Lorem ipsum dolor</a></li>
							<li><a href="#">Magna phasellus</a></li>
							<li><a href="#">Etiam dolore nisl</a></li>
							<li>
								<a href="#">Phasellus consequat</a>
								<ul>
									<li><a href="#">Magna phasellus</a></li>
									<li><a href="#">Etiam dolore nisl</a></li>
									<li><a href="#">Veroeros feugiat</a></li>
									<li><a href="#">Nisl sed aliquam</a></li>
									<li><a href="#">Dolore adipiscing</a></li>
								</ul>
							</li>
							<li><a href="#">Veroeros feugiat</a></li>
						</ul>
					</li>
					<li><a href="left-sidebar.html">Left Sidebar</a></li>
					<li><a href="right-sidebar.html">Right Sidebar</a></li>
					<!-- insert account.html here-->
					<li><a href="account.html">Account</a></li>
				</ul>
			</nav>

			<!-- Banner -->
			<section id="banner">
				<header>
					<h2>Events</h2>
					<p>View events happening now</p>
				</header>
				<header class="icon">
					<h2>Add Event</h2>
					<p><a href="add_event.html">Click me to add new events!</a></p>
				</header>
			</section>
		</section>

		<!-- Main -->
		<section id="main">
            <div class="container">
                <div class="row" id="eventsContainer"></div>
            </div>
        </section>

		<!-- Footer -->
		<section id="footer">
			<div class="container">
				<div class="row">
					<div class="col-4 col-12-medium">
						<section>
							<header>
								<h2>TicketMaster</h2>
							</header>
							<ul class="social">
								<li><a class="icon brands fa-facebook-f" href="#"><span class="label">Facebook</span></a></li>
								<li><a class="icon brands fa-twitter" href="#"><span class="label">Twitter</span></a></li>
								<li><a class="icon brands fa-dribbble" href="#"><span class="label">Dribbble</span></a></li>
								<li><a class="icon brands fa-tumblr" href="#"><span class="label">Tumblr</span></a></li>
								<li><a class="icon brands fa-linkedin-in" href="#"><span class="label">LinkedIn</span></a></li>
							</ul>
							</section>
							</div>
							<section>
									<h3>Address</h3>
									<p>
										Untitled Incorporated<br />
										1234 Somewhere Road Suite<br />
										Nashville, TN 00000-0000
									</p>
							</section>
							<section>
									<h3>Mail</h3>
									<p><a href="#">someone@untitled.tld</a></p>
							</section>
							<section>
									<h3>Phone</h3>
									<p>(800) 000-0000</p>
						</section>
					</div>
					<div class="col-12">

						<!-- Copyright -->
							<div id="copyright">
								<ul class="links">
									<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
								</ul>
							</div>
					</div>
			</div>
		</section>
	</div>

	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/jquery.dropotron.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

</body>

</html>